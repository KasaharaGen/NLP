Q: MBP Mid 2009 thinks the lid is closed permanently As the title suggests I have a mid 2009 MBP that has started behaving as if the lid is permanently closed.
It started happening while the machine was on with the AC plugged in, it was in use and simply went to sleep. Pressing the power button brought it back on for approximately 2 seconds before it went back to sleep. Hard power off and on again now results in the machine booting up fine but as soon as the login screen is displayed it goes to sleep.
I can plug in an external monitor and use it that way as if the machine was in closed-lid mode.
Unplugging the external monitor switches the display back to the laptop for 2 seconds before it goes to sleep.
I have reset the PRAM and SMC to no effect.
As a workaround I have installed InsomniaX so that the machine doesn't go to sleep when it thinks the lid is closed. Obviously this is not ideal and I wondered if anyone had any suggestions?
Edit
/private/var/log/system.log searching for 'sleep' around the time it first happened
May 23 04:25:26 Mitsuo Alarm Clock[638]: kIOMessageSystemWillSleep
May 23 04:25:26 Mitsuo loginwindow[29]: loginwindow SleepWakeCallback WILL sleep
May 23 04:26:01 Mitsuo loginwindow[29]: loginwindow SleepWakeCallback will power on, Currenttime:5/23/2011 4:26:01.018 AM - Waketime:5/23/2011 4:26:00.010 AM = Deltatime:1.007693946
May 23 04:26:03 Mitsuo configd[13]: Sleep: Success - AC 98 - Clamshell Sleep
May 23 04:26:06 Mitsuo loginwindow[29]: loginwindow SleepWakeCallback WILL sleep
May 23 04:26:07 Mitsuo Alarm Clock[638]: kIOMessageSystemWillSleep
May 23 04:26:53 Mitsuo configd[13]: Sleep: Success - AC 98 - Clamshell Sleep
May 23 04:27:00 Mitsuo loginwindow[29]: loginwindow SleepWakeCallback will power on, Currenttime:5/23/2011 4:26:54.628 AM - Waketime:5/23/2011 4:26:46.000 AM = Deltatime:8.628412008
May 23 04:27:09 Mitsuo Alarm Clock[638]: kIOMessageSystemWillSleep
May 23 04:27:54 localhost configd[13]: Sleep - Filtered Sleep Failure Report - Power Button Shutdown - Apps Failure
May 23 04:28:19 Mitsuo configd[13]: Sleep: Success - AC 98 - Clamshell Sleep
May 23 04:28:31 Mitsuo configd[13]: Sleep: Success - AC 98 - Clamshell Sleep
May 23 04:28:45 Mitsuo configd[13]: Sleep: Success - AC 98 - Clamshell Sleep
May 23 04:30:03 localhost configd[13]: Sleep: Success - BATT 97
May 23 04:33:12 Mitsuo configd[13]: Sleep: Success - BATT 97 - Clamshell Sleep
May 23 04:33:28 Mitsuo configd[13]: Sleep: Success - BATT 97 - Clamshell Sleep
May 23 04:33:41 Mitsuo configd[13]: Sleep: Success - BATT 96 - Clamshell Sleep
May 23 04:34:46 localhost configd[13]: Sleep: Drivers Failure - BATT 96 - RP01 IXVE
May 23 04:35:30 Mitsuo configd[13]: Sleep: Success - BATT 95 - Clamshell Sleep
May 23 04:43:55 localhost configd[13]: Sleep: Platform Failure - BATT 94
May 23 04:45:33 Mitsuo configd[13]: Sleep: Success - BATT 93 - Clamshell Sleep
May 23 04:47:39 Mitsuo configd[13]: Sleep: Success - BATT 93 - Clamshell Sleep
May 23 04:47:58 Mitsuo configd[13]: Sleep: Success - BATT 92 - Clamshell Sleep
May 23 04:48:13 Mitsuo configd[13]: Sleep: Success - BATT 92 - Clamshell Sleep
May 23 04:49:55 Mitsuo configd[13]: Sleep: Success - BATT 91 - Clamshell Sleep
May 23 04:50:51 localhost configd[13]: Sleep: Platform Failure - BATT 90
May 23 04:52:35 Mitsuo configd[13]: Sleep: Success - BATT 89 - Clamshell Sleep

All messages searching for 'cause'
23/05/2011 18:44:16 kernel  Previous Sleep Cause: 5
23/05/2011 18:46:53 kernel  AirPort: Link Down on en1. Reason 8 (Disassociated because station leaving).
23/05/2011 19:06:01 kernel  Previous Sleep Cause: 5
23/05/2011 19:12:17 kernel  Previous Sleep Cause: 5
24/05/2011 08:29:43 kernel  Previous Sleep Cause: 5
24/05/2011 09:20:37 kernel  Previous Sleep Cause: 5
24/05/2011 09:28:06 kernel  Previous Shutdown Cause: 5
24/05/2011 12:04:58 kernel  Previous Shutdown Cause: 0
24/05/2011 12:05:04 kernel  AirPort: Link Down on en1. Reason 8 (Disassociated because station leaving).
24/05/2011 12:05:20 kernel  AirPort: Link Down on en1. Reason 8 (Disassociated because station leaving).
24/05/2011 12:05:35 kernel  Previous Sleep Cause: 5

Update
The problem is almost certainly the sleep sensor. I have booted up into my Windows boot camp partition and the screen remains off as if the lid is closed. Plugging in an external monitor also works in Windows.
Given the link to iFixit (which I hadn't thought to look at) I'm going to have a look at the sleep sensor and see if there is any obvious fault. Failing that, I have found a couple of nearby service centres at the link provided by bckbck in the comments. Thanks.

A: The sleep sensor or MLB is likely faulty. A visit to the genius bar might be a good next step. Also posting the system.log sleep messages might help us determine the reason the mac is triggering sleep - search for "cause" using the console.app
EDIT: Thanks for adding the console messages - the system is certainly getting a signal telling it the display is shut. It's possible (but very unlikely) a new OS install from scratch would let the system read the sensor properly (software corruption can never be ruled out without trying a clean install). It's very likely the component in your mac housing the sleep sensor went bad as when the sensor fails on it's typically the sensor and not the cable or logic board at fault.
