Q: How can I troubleshoot Kernel Panics on my iMac I recently started to see kernel panics on my iMac, that I believe has something to do with my hard drives. Not so sure though. How can I try to track down the cause of this error? 
Interval Since Last Panic Report:  286906 sec
Panics Since Last Report:          3
Anonymous UUID:                    5C1C49C6-F8B7-468E-B057-3ED4230448B1

Fri May 27 07:55:59 2011
panic(cpu 0 caller 0x2aab59): Kernel trap at 0x01212827, type 14=page fault, registers:
CR0: 0x80010033, CR2: 0x00000008, CR3: 0x00101000, CR4: 0x00000660
EAX: 0x00000000, EBX: 0x360ab83c, ECX: 0x00000000, EDX: 0x0000000a
CR2: 0x00000008, EBP: 0x360ab818, ESI: 0x0955c40c, EDI: 0x00000000
EFL: 0x00010206, EIP: 0x01212827, CS:  0x00000004, DS:  0x0000000c
Error code: 0x00000000

Backtrace (CPU 0), Frame : Return Address (4 potential args on stack)
0x360ab608 : 0x21b510 (0x5d9514 0x360ab63c 0x223978 0x0) 
0x360ab658 : 0x2aab59 (0x59aeec 0x1212827 0xe 0x59b0b6) 
0x360ab738 : 0x2a09b8 (0x360ab758 0xb0ff1e0 0x6017f80 0x0) 
0x360ab750 : 0x1212827 (0xe 0x48 0x70 0x360a000c) 
0x360ab818 : 0x2fbce4 (0x360ab83c 0x2e0063 0x70006d 0x330033) 
0x360ab868 : 0x2fd63a (0x955c40c 0x360aba00 0x7259364 0x2d031d) 
0x360ab8b8 : 0x2e31cc (0x955c40c 0x360aba00 0x7259364 0x0) 
0x360abb48 : 0x46ba55 (0xa505030 0x0 0x880 0x7259364) 
0x360abb88 : 0x2dd78f (0x50faa04 0xa505030 0x880 0x7259364) 
0x360abbd8 : 0x2f37f7 (0x955c40c 0x0 0x880 0x7259364) 
0x360abc18 : 0x2e987a (0x955c40c 0x360abd00 0x0 0x1) 
0x360abd88 : 0x2e9c2b (0xb0102464 0x0 0x0 0x0) 
0x360abf48 : 0x2e9cc4 (0xb0102464 0x0 0x0 0x0) 
0x360abf78 : 0x4f5d0a (0x55c0540 0x7259260 0x72592a4 0x0) 
0x360abfc8 : 0x2a0f08 (0x6bd16b8 0x0 0x4 0x6bd16b8) 
No mapping exists for frame pointer
Backtrace terminated-invalid frame pointer 0xb0102948
      Kernel Extensions in backtrace (with dependencies):
         com.apple.filesystems.ntfs(3.4)@0x1206000->0x1265fff

BSD process name corresponding to current thread: mds

Mac OS version:
10J869

Kernel version:
Darwin Kernel Version 10.7.0: Sat Jan 29 15:17:16 PST 2011; root:xnu-1504.9.37~1/RELEASE_I386
System model name: iMac4,1 (Mac-F42787C8)

System uptime in nanoseconds: 7353051704701
unloaded kexts:
com.apple.driver.AirPortBrcm43xx    423.91.27 (addr 0xbaf000, size 0x1900544) - last unloaded 96412687551
loaded kexts:
com.parallels.kext.Pvsvnic  3.0
com.parallels.kext.vmmain   3.0
com.parallels.kext.hypervisor   3.0
com.bresink.driver.BRESINKx86Monitoring 2.0
com.vmware.kext.vmnet   2.0.4
com.vmware.kext.vmioplug    2.0.4
com.vmware.kext.vmci    2.0.4
com.vmware.kext.vmx86   2.0.4
com.Cycling74.driver.Soundflower    1.5.1
com.parallels.kext.Pvsnet   3.0
com.parallels.kext.ConnectUSB   3.0.0
com.apple.filesystems.msdosfs   1.6.3 - last loaded 41648076027
com.apple.filesystems.ntfs  3.4
com.apple.driver.AppleHWSensor  1.9.3d0
com.apple.driver.AppleHDA   1.9.9f12
com.apple.driver.AppleUpstreamUserClient    3.5.4
com.apple.driver.AppleMCCSControl   1.0.17
com.apple.driver.ACPI_SMC_PlatformPlugin    4.5.0d5
com.apple.driver.AppleLPC   1.4.12
com.apple.driver.AppleBacklight 170.0.34
com.apple.filesystems.autofs    2.1.0
com.apple.kext.ATIFramebuffer   6.2.6
com.apple.driver.AudioAUUC  1.54
com.apple.ATIRadeonX1000    6.2.6
com.apple.driver.AppleIntelYonahProfile 21
com.apple.Dont_Steal_Mac_OS_X   7.0.0
com.apple.iokit.CHUDUtils   364
com.apple.iokit.CHUDProf    366
com.apple.driver.AudioIPCDriver 1.1.6
com.apple.driver.AppleIRController  303.8
com.apple.iokit.SCSITaskUserClient  2.6.5
com.apple.iokit.IOAHCIBlockStorage  1.6.3
com.apple.BootCache 31
com.apple.AppleFSCompression.AppleFSCompressionTypeZlib 1.0.0d1
com.apple.driver.AppleAHCIPort  2.1.5
com.apple.driver.AppleIntelPIIXATA  2.5.1
com.apple.driver.AppleUSBHub    4.1.7
com.apple.driver.AirPortBrcm43224   427.36.9
com.apple.iokit.AppleYukon2 3.2.1b1
com.apple.driver.AppleHPET  1.5
com.apple.driver.AppleFWOHCI    4.7.1
com.apple.driver.AppleUSBEHCI   4.1.8
com.apple.driver.AppleUSBUHCI   4.1.5
com.apple.driver.AppleEFINVRAM  1.4.0
com.apple.driver.AppleRTC   1.3.1
com.apple.driver.AppleACPIButtons   1.3.5
com.apple.driver.AppleSMBIOS    1.6
com.apple.driver.AppleACPIEC    1.3.5
com.apple.driver.AppleAPIC  1.4
com.apple.driver.AppleIntelCPUPowerManagementClient 105.13.0
com.apple.security.sandbox  1
com.apple.security.quarantine   0
com.apple.nke.applicationfirewall   2.1.11
com.apple.driver.AppleIntelCPUPowerManagement   105.13.0
com.apple.driver.DspFuncLib 1.9.9f12
com.apple.driver.AppleProfileReadCounterAction  25
com.apple.driver.IOPlatformPluginFamily 4.5.0d5
com.apple.iokit.IOFireWireIP    2.0.3
com.apple.driver.AppleHDAController 1.9.9f12
com.apple.iokit.IOHDAFamily 1.9.9f12
com.apple.driver.AppleProfileTimestampAction    18
com.apple.driver.AppleProfileThreadInfoAction   23
com.apple.driver.AppleProfileRegisterStateAction    19
com.apple.driver.AppleProfileKEventAction   18
com.apple.driver.AppleProfileCallstackAction    34
com.apple.iokit.IONDRVSupport   2.2
com.apple.kext.ATI1600Controller    6.2.6
com.apple.kext.ATISupport   6.2.6
com.apple.iokit.IOSurface   74.2
com.apple.iokit.IOGraphicsFamily    2.2
com.apple.iokit.IOBluetoothSerialManager    2.4.0f1
com.apple.iokit.IOSerialFamily  10.0.3
com.apple.driver.AppleSMC   3.1.0d3
com.apple.iokit.CHUDKernLib 365
com.apple.iokit.IOAudioFamily   1.8.0fc1
com.apple.kext.OSvKernDSPLib    1.3
com.apple.iokit.AppleProfileFamily  56
com.apple.driver.CSRUSBBluetoothHCIController   2.4.0f1
com.apple.driver.AppleUSBBluetoothHCIController 2.4.0f1
com.apple.iokit.IOBluetoothFamily   2.4.0f1
com.apple.driver.AppleUSBHIDMouse   162
com.apple.driver.AppleHIDMouse  162
com.apple.iokit.IOUSBHIDDriver  4.1.5
com.apple.driver.AppleUSBMergeNub   4.1.8
com.apple.iokit.IOSCSIBlockCommandsDevice   2.6.5
com.apple.iokit.IOUSBMassStorageClass   2.6.5
com.apple.driver.AppleUSBComposite  3.9.0
com.apple.iokit.IOSCSIMultimediaCommandsDevice  2.6.5
com.apple.iokit.IOBDStorageFamily   1.6
com.apple.iokit.IODVDStorageFamily  1.6
com.apple.iokit.IOCDStorageFamily   1.6
com.apple.driver.XsanFilter 402.1
com.apple.iokit.IOATAPIProtocolTransport    2.5.1
com.apple.iokit.IOSCSIArchitectureModelFamily   2.6.5
com.apple.iokit.IOAHCIFamily    2.0.4
com.apple.iokit.IOATAFamily 2.5.1
com.apple.iokit.IOUSBUserClient 4.1.5
com.apple.iokit.IO80211Family   314.1.1
com.apple.iokit.IONetworkingFamily  1.10
com.apple.iokit.IOFireWireFamily    4.2.6
com.apple.iokit.IOUSBFamily 4.1.8
com.apple.driver.AppleEFIRuntime    1.4.0
com.apple.iokit.IOHIDFamily 1.6.5
com.apple.iokit.IOSMBusFamily   1.1
com.apple.kext.AppleMatch   1.0.0d1
com.apple.security.TMSafetyNet  6
com.apple.driver.DiskImages 289
com.apple.iokit.IOStorageFamily 1.6.2
com.apple.driver.AppleACPIPlatform  1.3.5
com.apple.iokit.IOACPIFamily    1.3.0
com.apple.iokit.IOPCIFamily 2.6
Model: iMac4,1, BootROM IM41.0055.B08, 2 processors, Intel Core Duo, 2 GHz, 2 GB, SMC 1.1f5
Graphics: ATI Radeon X1600, ATY,RadeonX1600, PCIe, 128 MB
Memory Module: global_name
AirPort: spairport_wireless_card_type_airport_extreme (0x14E4, 0x89), Broadcom BCM43xx 1.0 (5.10.131.36.9)
Bluetooth: Version 2.4.0f1, 2 service, 19 devices, 1 incoming serial ports
Network Service: Ethernet, Ethernet, en0
Network Service: Parallels Host-Guest, Ethernet, en2
Network Service: Parallels NAT, Ethernet, en3
Serial ATA Device: WDC WD2500JS-40NGB2, 232.89 GB
Parallel ATA Device: MATSHITADVD-R   UJ-846
USB Device: External HDD, 0x1058  (Western Digital Technologies, Inc.), 0x0901, 0xfd100000
USB Device: Hub in Apple Pro Keyboard, 0x05ac  (Apple Inc.), 0x1003, 0x5d100000
USB Device: Apple Optical USB Mouse, 0x05ac  (Apple Inc.), 0x0304, 0x5d110000
USB Device: Apple Pro Keyboard, 0x05ac  (Apple Inc.), 0x020c, 0x5d130000
USB Device: Bluetooth USB Host Controller, 0x05ac  (Apple Inc.), 0x8206, 0x7d100000
USB Device: IR Receiver, 0x05ac  (Apple Inc.), 0x8240, 0x7d200000


A: Kernel Panics are some of the hardest to debug unless you have one that you know exactly how to trigger it. In that case, it's pretty easy to keep eliminating possibilities until the source is obvious.
Here is the best writeup of Mac specific information on Understanding and Debugging Kernel Panics. It is very technical, so take what you wish and move on to the steps below.
Like anything, it's best to isolate the problem to avoid chasing down thousands of potential causes. It's best to be systematic about how you isolate issues, so here are the two articles I would start with in the case of a kernel panic. You will start with general steps and then isolate software before hardware and eventually reinstall the OS.


*

*Isolating issues in Mac OS X - great general reference, links to specific sub articles

*Mac OS X: How to troubleshoot a software issue
In your specific case - the last code on the stack seems to point to Spotlight (mds) processing NTFS (windows) data so you might pay particular attention to any windows drives that are connected in case there is a relation to the crash. Keep in mind, the stack trace is sometimes wrong and you see some innocent bystander was running on the CPU at the time of the crash. Good Luck!

A: If I had to guess, I'd say it was caused by the ntfs driver. Since the driver  itself is very stable, I suspect something is going on with your drives that is causing it. I suggest checking your drives' SMART status as well as check in the console to see if there is anything interesting there.
EDIT 5/28/2011:
The mds process is likely the trigger, and it's failing on processing something on one of your NTFS-formatted drives. This could either be Spotlight crashing on reading a file or the driver itself crashing. To determine if the driver is at fault, you could try the NTFS-3G driver (http://macntfs-3g.blogspot.com/ -- they also have a commercial product called Tuxera) and see if the panics continue to occur. (Side benefit: you can write to your NTFS drives.)
Furthermore, have you added or installed any files recently? If there is a specific file that is causing mds to crash, removal of the file should take care of the problem. (That said, mds itself shouldn't cause a full kernel panic.)
The kernel panic here is what tells me that something is either going on at the driver level (which should be the only things that cause panics -- normally) or at the hard-drive level. I would again suggest checking the drive status to determine that a drive isn't failing and causing the Apple NTFS driver to panic. In this case, I would expect the NTFS-3G driver would either throw an error or panic as well. If the drive is failing, it will be visible in your drive's S.M.A.
